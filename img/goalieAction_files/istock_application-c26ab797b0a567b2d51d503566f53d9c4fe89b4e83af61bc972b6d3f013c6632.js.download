(function(){angular.module("AdpApp").requires.push("iStockDownload"),this.IStockDownload=angular.module("iStockDownload",["giTranslation","ngMessages","giTracking","giEvents","giExperiences","ngRedux"]).config(["$ngReduxProvider",function(e){var t;return t=[ReduxThunk["default"]],window.reduxLogger&&t.push(window.reduxLogger.createLogger({diff:!0,duration:!0,collapsed:!0,stateTransformer:function(e){return e.adp.toJS()}})),e.createStoreWith(function(){return{}},t)}]).run(["$rootScope","t","$ngRedux","rootReducer",function(e,t,n,i){return e.t=t,n.replaceReducer(Redux.combineReducers({adp:i}))}])}).call(this),function(){this.IStockDownload.factory("assetDetailService",function(){var e,n,i,r,o,c,a,s,l,u,d,_;return e={Small:"small_file_size",Medium:"medium_file_size",Large:"large_file_size",Xlarge:"xlarge_file_size",Xxlarge:"xxlarge_file_size",eps:"EPS",epsUnavailable:"EPS"},i=function(e){var t;return"film"!==e.type&&d(e.imageSizes),{assetId:e.id,assetFamily:e.family,assetType:e.type,istockCollection:e.istockCollection,mediaType:e.mediaType,freeFile:e.isFreeFile,agreements:e.agreements,includedWithSubscription:0<=(null!=(t=e.agreements)?t.indexOf("RF"):void 0),licenseType:e.license,standardLicense:e.standardLicense,sizes:r(e.imageSizes,e.type,e.mediaType),hasEpsFileSize:l,epsFileSizeIndex:n}},u=null,n=null,l=!1,d=function(e){var t;if(n=e.findIndex(function(e){return"eps"===e.name}),l=0<=n)return t=e[n],t.teeShirtSize=t.name,t.isEps=!0},r=function(e,n,i){return"film"===n?e:("illustration"!==i||l||e.push({name:"epsUnavailable",teeShirtSize:"epsUnavailable",description:t("eps_not_available"),epsUnavailable:!0}),e)},s=function(){return e},a=function(){return l?"istock_user_preferred_eps_download_size":"istock_user_preferred_download_size"},c=function(){var e;return null!=(e=window.sessionStorage)?e.istock_user_preferred_download_size:void 0},o=function(){var e;return null!=(e=window.sessionStorage)?e.istock_user_preferred_eps_download_size:void 0},_=function(e){var t;if(u!==e)return u=e,null!=(t=window.sessionStorage)?t[a()]=e:void 0},{formatAsset:i,getSizeMap:s,getPreferredSize:c,getEpsPreferredSize:o,setPreferredSize:_}})}.call(this),function(){var e;e=function(){var e,t,n,i,r,o,c;if(n={isCraftManager:!1,isPhotoshop:!1,isSketch:!1},e={isDownloaded:!1},i=function(e,t){var n,i,r,o,c,a;return n=null!=(i=e.channel)?i.platforms:void 0,(null!=n&&null!=(r=n[t])?r.installed:void 0)&&(null!=n&&null!=(o=n[t])&&null!=(c=o.products)&&null!=(a=c["com.invisionlabs.getty"])?a.enabled:void 0)},function(){return $.ajax({url:"https://labslocalhost.com:24679/check",type:"GET",success:function(e){return n.isCraftManager=!0,i(e,"sketch")&&(n.isSketch=!0),i(e,"photoshop")&&(n.isPhotoshop=!0),n.isSketch||n.isPhotoshop?($(".craft-plugin").addClass("active"),n.isSketch&&$(".sketch-link").addClass("active"),n.isPhotoshop&&$(".photoshop-link").addClass("active"),t()):r()},error:function(){return r()}})},r=function(){return $(".no-craft").addClass("active")},t=function(){var t,n;return n=$(".sketch-link"),t=$(".photoshop-link"),$(document).on("track.singleDownload",function(){return e.isDownloaded=!0,$(".craft-plugin:not(.download)").css("display","none")}),n.on("click",function(){return c("Sketch")}),t.on("click",function(){return c("Photoshop")}),{}},o=function(e,t){if(null==t&&(t=""),"undefined"==typeof s||null===s)return!1;switch(s.linkTrackEvents=e,s.events=e,e){case"event182":s.linkTrackVars="events",s.tl(!0,"o","craft_promo_banner_download");break;case"event183":case"event184":s.linkTrackVars="events,eVar87",s.eVar87=t,s.tl(!0,"o","adp|icon");break;case"event185":s.linkTrackVars="events",s.tl(!0,"o","craft_promo_banner_visible")}return s.linkTrackVars="",s.events="",!0},c=function(t){var n;return n=e.isDownloaded?"event184":"event183",o(n,t)},("undefined"!=typeof currentSite&&null!==currentSite?currentSite.isiStock:void 0)&&"image"===window.tracking_data.asset_details.asset_type)return r()},this.CraftPluginTest=function(){function t(){}return t.prototype.initCraftTest=function(){return e()},t}(),$(document).safeReady(function(){return e()})}.call(this),function(){this.IStockDownload.directive("downloadError",["downloadErrorService",function(e){return this.downloadErrorService=e,{link:function(e){return e.downloadErrorService=this.downloadErrorService,e.showError=!1},restrict:"A",replace:!0,template:'<div ng-if="downloadErrorService.showError()" class="error-bar">{{downloadErrorService.getErrorMessage()}}</div>'}}])}.call(this),function(){this.IStockDownload.factory("downloadErrorService",["t",function(e){var t,n,i,r,o;return n=!1,i="download_failed",o=function(){return n},t=function(e){if(n=!0,null!=e)return i=e},r=function(){return e(i)},{showError:o,displayError:t,getErrorMessage:r}}])}.call(this),function(){var e;$("#close-inline-purchase").click(function(){return e()}),$("#close-inline-purchase").on("tap",function(){return e()}),$("main .inline-purchase .grey-out").click(function(){return e()}),$("main .inline-purchase .grey-out").on("tap",function(){return e()}),e=function(){var e;return e=$("main .inline-purchase"),e.fadeOut("slow",function(){return e.remove()})},$(document).on("omnitureReady",function(){var e,t;if(e="inline_purchase",$.cookie(e))return t=JSON.parse($.cookie(e)),$(document).trigger("track.inlinePurchase",t)})}.call(this),function(){this.IStockDownload.controller("IstockDownloadController",["$scope","$rootScope","$window","$q","$sce","$ngRedux","assetDetailService","downloadErrorService","giLocalStorage","pricingClarityUrlService","plansAndPricingUrlService","userDetailsService","TodService","actions","t","accountTypes","agreementTypes",function(e,t,n,i,r,o,c,a,s,l,u,d,_,S,f,p,T){var I,E,A;return A=function(i){var o,s;return i=i.adp,i.displayError&&a.displayError(i.displayError),i.redirectToUrl&&(n.location.href=i.redirectToUrl),i.downloadData&&(t.downloadDestinations=i.downloadData.download_destinations),i.calc.assetIsVideo?e.videoSizes||I(i.asset.sizes):(null!=(s=i.calc.selectedAssetSize)?s.teeShirtSize:void 0)&&c.setPreferredSize(i.calc.selectedAssetSize.teeShirtSize),i.calc.step.additionalInfoHtml&&(o=r.trustAsHtml(i.calc.step.additionalInfoHtml)),{user:i.user,asset:i.asset,size:i.calc.selectedAssetSize,agreements:i.agreements,licenses:i.licenses,calc:i.calc,step:i.calc.step,additionalInfoHtml:o,canPeekAtCost:i.calc.selectedAgreementType&&i.calc.hasSelectedOptionalLicenses,isChoiceToPayByCreditPack:i.calc.selectedAgreementType===T.CREDIT_PACK}},e.init=function(t,n,i){return e.$on("$destroy",o.connect(A,S)(e)),e.accountTypes=p,e.agreementTypes=T,e.mubRedirectUrl=i,e.initializeDataStep(c.formatAsset(JSON.parse(t)),d.formatUser(n),tracking_data.geolocation_country,c.getPreferredSize(),c.getEpsPreferredSize()),e.goToInitialLoad()},I=function(t){return e.videoSizes=t.filter(function(e){return null!=e.description}).toArray(),e.selectedVideoSize=e.videoSizes[e.videoSizes.length-1],e.selectAssetSize(e.selectedVideoSize)},e.mapSizeToLabelTag=function(e){var t;return t=c.getSizeMap()[e.teeShirtSize],e.isEps||e.epsUnavailable?t:f(t)},e.hoverSize=function(t){return e.size=t},e.unhoverSize=function(){return e.size=e.calc.selectedAssetSize},e.getCtaAction=function(){return E(!0),e.step.triggerTracking?e.step.triggerTracking():console.error("Missing trigger tracking for "+e.step.name),i.when(e.$eval("("+e.step.ctaAction+"())"))["finally"](function(){return E(!1)})},E=function(t){var n,i;return e.setCtaInProgress(t),i=angular.element("#download-button"),n=t?i.outerWidth():i.width(""),i.width(n)},e._redirectTo=function(e){return n.location.href=e},e._inPricingClarityButNotPickingLicenses=function(){return e.calc.isInPricingClarity&&e.step.showPricingClarity&&!e.step.viewLicenseSelection},e.redirectToPricing=function(t){var n;return null==t&&(t={}),t.chooseSubscription&&$.storageQueueManager.cookieStore.set("purchase-path-entry-point","adp-subscription"),n=u.getPricingRoute(e.calc.assetIsVideo),e._inPricingClarityButNotPickingLicenses()&&(n=l.getPricingUrl(n)),e._redirectTo(n)},e.redirectToCheckout=function(t){var n,i,r,o;return null==t&&(t={}),"essentialsSubscription"===(i=t.cartItem)||"signatureSubscription"===i?(r={essentialsSubscription:"SUBISTOCK1M10",signatureSubscription:"SUBISTOCKPREM1M10"}[t.cartItem],o="/purchase/subscriptions/"+r,e._inPricingClarityButNotPickingLicenses()&&(o=l.getCheckoutUrl(o,!0,e.asset.assetId))):(n="moreThanOneCredit"===t.cartItem?"CREDITPCK3":"CREDITPCK1",$.storageQueueManager.cookieStore.set("purchase-path-entry-point","adp-creditPack"),o="/purchase/credits/"+n,e._inPricingClarityButNotPickingLicenses()&&(o=l.getCheckoutUrl(o,!0,e.asset.assetId))),e._redirectTo(o)},e.handleAccountSelection=function(){return angular.element("#download-button").trigger("track.choose_account",e.calc.selectedAccount),e.goToNextStep()},e.createDownload=function(t){return window.tracking_data.asset_details.asset_size=e.size.name,e.calc.selectedAgreementSize?(_.requiresTranscoding(e.calc.selectedAgreementSize)&&_.triggerPopup(),e.performDownload(n.korrelationId,e.mubRedirectUrl,t)):a.displayError()},e.requiresTranscoding=function(e){return _.requiresTranscoding(e)},e.trackHover=function(e){return _.trackHoverTriggered(e)},e.goToEditor=function(t,i){var r;return angular.element(t.currentTarget).trigger("track.edit_this_photo"),r="/editor/"+e.asset.assetId,i&&(r+="?linkSrc="+encodeURIComponent(i)),n.location.href=n.siteMap.cleanRelativePath(r)}}])}.call(this),function(){this.IStockDownload.controller("IstockLicensesController",["$scope","$ngRedux","actions",function(e,t,n){var i;return i=function(e){return{asset:e.adp.asset,licenses:e.adp.licenses}},e.init=function(){return e.$on("$destroy",t.connect(i,n)(e))}}])}.call(this),function(){this.IStockDownload.factory("plansAndPricingUrlService",function(){var e,n,i,r,o;return e=function(e){return e?i():n()},i=function(){return r("urls.plans_and_pricing_video")},n=function(){return r("urls.plans_and_pricing_images")},function(){return r("urls.plans_and_pricing")},r=function(e){var n;return n="/"+t(e),o(window.siteMap.cleanRelativePath(n))},o=function(e){return/(.*)JS translation missing(.*)/.test(e)?window.siteMap.cleanRelativePath("/plans-and-pricing"):e},{getPricingRoute:e}})}.call(this),function(){this.IStockDownload.factory("pricingClarityUrlService",["$window",function(e){var t,n,i;return i=function(e,t){return null==t&&(t=!0),n(e,"pricing",t)},t=function(e,t,i){return null==t&&(t=!0),null==i&&(i=null),n(e,"checkout",t,i)},n=function(t,n,i,r){var o,c,a;return null==i&&(i=!0),null==r&&(r=null),"checkout"===n?a=i?"?":"&":(c=t.search(/\?/),a=c<0?"?":"&"),o=r?"fastcheckoutasset="+r:"in-pricing-clarity=true",t+=a+o,e.siteMap.cleanRelativePath(t)},{getPricingUrl:i,getCheckoutUrl:t}}])}.call(this),function(){this.IStockDownload.factory("userDetailsService",["assetCollectionNames",function(e){var t,n,i,r;return r={subsInfo:{}},t=function(e){return null==e&&(e={}),r=e,r.credit_amount=r.credit_amount||0,r.authenticated=r.authenticated||!1,r.remembered=r.remembered||!1,r.team_member=r.team_member||!1,r.team_leader=r.team_leader||!1,r.has_credits=r.has_credits||!1,r.has_subscription=r.has_subscription||!1,r.has_subs_downloads=r.has_subs_downloads||!1,r.team_credits=r.team_credits||0,r.team_name=r.team_name||"",r.fast_checkout_test=r.fast_checkout_test||!1,n(),i(r),r},n=function(t){var n;return null==t&&(t={}),n=t.name||"",r.subsInfo={isSignature:e.isSignature(n),isEssentials:e.isEssentials(n),downloadedCount:t.download_count||0,downloadLimit:t.download_limit||0,autoRenews:!!t.is_auto_renewal,daysUntilExpiry:t.days_until_product_expires||0},r.subsInfo.downloadsRemaining=r.subsInfo.downloadLimit-r.subsInfo.downloadedCount},i=function(e){return window.tracking_data.has_purchased=e.has_purchase_history,window.tracking_data.has_credits=e.has_credits,window.tracking_data.has_subscription=e.has_subscription,window.tracking_data.has_subs_downloads=e.subsInfo.downloadsRemaining>0,window.tracking_data.remembered=e.remembered,window.tracking_data.authenticated=e.authenticated,window.tracking_data.fast_checkout_test=e.fast_checkout_test},{formatUser:t}}])}.call(this),function(){this.IStockDownload.factory("actions",["actionTypes","performDownloadAction","pickOptionalLicensesAction","initiateDownloadAction","setSelectedAccountAction","goToFirstStepAction","goToNextStepAction","goToInitiateDownloadAndSelectLicensesStepAction",function(e,t,n,i,r,o,c,a){return{initializeDataStep:function(t,n,i,r,o){return{type:e.INITIALIZE,asset:t,user:n,geolocation_country:i,preferredDownloadSize:r,preferredEpsDownloadSize:o}},goToFirstStep:function(){return{type:e.GO_TO_BEGINNING}},selectAssetSize:function(t){return{type:e.SELECT_ASSET_SIZE,assetSize:t}},setCtaInProgress:function(t){return{type:e.SET_CTA_IN_PROGRESS,inProgress:t}},checkLicense:function(t){return{type:e.CHECK_LICENSE,licenseIndex:t}},selectPricingClarityOptionToggle:function(){return{type:e.SELECT_PRICING_CLARITY_OPTION_TOGGLE}},setSelectedAgreementType:function(t){return{type:e.SELECT_AGREEMENT_TYPE,agreementType:t}},goToInitialLoad:o,goToNextStep:c,setSelectedAccount:r,initiateDownload:i,pickOptionalLicenses:n,performDownload:t,goToInitiateDownloadAndSelectLicensesStep:a}}])}.call(this),function(){this.IStockDownload.factory("initialState",["stateSteps",function(e){return DeepRecord.fromJS({user:{country_code:"",authenticated:!1,remembered:!1,anonymous:!0,has_subscription:!1,has_purchase_history:!1,team_member:!1,team_leader:!1,team_name:"",disable_pricing_clarity:!0,credit_amount:0,has_credits:!1,has_subs_downloads:!1,team_credits:0,fast_checkout_test:!1,subsInfo:{isSignature:!1,isEssentials:!1,downloadedCount:0,downloadLimit:0,autoRenews:!1,daysUntilExpiry:0,downloadsRemaining:0}},asset:{assetType:"",agreements:[],assetFamily:"",assetId:"",licenseType:"",istockCollection:"",mediaType:"",freeFile:!1,hasEpsFileSize:!1,epsFileSizeIndex:-1,standardLicense:{license_type:"",description:"",credit_cost:Number.MAX_VALUE,is_purchase_required:!0,acquired:!1,is_acquired_and_not_repurchasable:!1,is_selected:!1},sizes:[]},agreements:[],licenses:[],calc:{step:{name:e.PICK_PAYMENT_OPTION,viewLicenseSelection:!1},assetIsIllustration:!1,assetIsImage:!1,assetIsVideo:!1,assetIsEasyAccess:!1,assetCollectionName:"",assetCollectionIsSignature:!1,geolocation_country:"USA",redownloadForFree:!1,isFreeAdminDownload:!1,teamCreditsAvailable:0,includedWithSubscription:!1,selectedAccount:void 0,selectedAccountCredits:0,selectedAccountHasAnyCredits:!1,selectedAccountHasEnoughCredits:!1,selectedAgreement:void 0,selectedAgreementType:void 0,selectedAgreementSize:void 0,selectedAssetSize:{},largestSizeAvailable:{},userIsTeamUser:!1,isTeamAccountSelected:!1,totalCreditCost:Number.MAX_VALUE,isInPricingClarity:!1,ctaInProgress:!1,showDropboxModal:void 0,showIncentivizationModal:void 0,hasSubscription:!1,isSubscriptionDownloadAllowed:!1,optionalLicenseIndexes:[],hasSelectedOptionalLicenses:!1,notAcquiredSelectedLicenses:[]},downloadData:null,displayError:null,redirectToUrl:null})}])}.call(this),function(){this.IStockDownload.factory("rootReducer",["initialState","actionTypes","initializeDataStepReducer","setInitialStepReducer","selectAssetSizeReducer","setCtaInProgressReducer","goToNextStepReducer","setAgreementsReducer","setToasterReducer","setSelectedAgreementTypeReducer","setLicensesReducer","freeAdminDownloadStepReducer","checkLicenseReducer","setAvailableCreditsReducer","completeDownloadStepReducer","setSelectedAccountReducer","togglePricingClarityOptionReducer","fetchUserAgreementsOverviewRespondedReducer","setDisplayErrorReducer","setRedirectBeforeInitiatingDownloadReducer","setRedirectUrlReducer","setDownloadDataReducer","chooseAccountStepReducer","goToInitiateDownloadAndSelectLicensesStepReducer",function(e,t,n,i,r,o,c,a,s,l,u,d,_,S,f,p,T,I,E,A,C,h,m,g){var D;return D={},D[t.INITIALIZE]=n,D[t.GO_TO_BEGINNING]=i,D[t.SELECT_ASSET_SIZE]=r,D[t.SET_CTA_IN_PROGRESS]=o,D[t.GO_TO_NEXT_STEP]=c,D[t.SET_AGREEMENTS]=a,D[t.SET_TOASTER]=s,D[t.SELECT_AGREEMENT_TYPE]=l,D[t.SET_LICENSES]=u,D[t.GO_TO_FREE_ADMIN_DOWNLOAD]=d,D[t.CHECK_LICENSE]=_,D[t.SET_AVAILABLE_CREDITS]=S,D[t.GO_TO_COMPLETE_DOWNLOAD]=f,D[t.SET_SELECTED_ACCOUNT]=p,D[t.SELECT_PRICING_CLARITY_OPTION_TOGGLE]=T,D[t.FETCH_USER_AGREEMENT_OVERVIEW_RESPONDED]=I,D[t.SET_DISPLAY_ERROR]=E,D[t.SET_REDIRECT_BEFORE_INITIATING_DOWNLOAD]=A,D[t.REDIRECT_TO_URL]=C,D[t.SET_DOWNLOAD_DATA]=h,D[t.SELECT_ACCOUNT_STEP]=m,D[t.GO_TO_INITIATE_DOWNLOAD_AND_SELECT_LICENSES_STEP]=g,Object.freeze(D),function(t,n){var i;return null==t&&(t=e),i=D[n.type],i?i(t,n):t}}])}.call(this),function(){this.IStockDownload.factory("accountTypes",function(){return{PERSONAL:"personalAccount",TEAM:"teamAccount"}})}.call(this),function(){this.IStockDownload.factory("actionTypes",function(){return{INITIALIZE:"INITIALIZE",SET_AVAILABLE_CREDITS:"SET_AVAILABLE_CREDITS",SET_AGREEMENTS:"SET_AGREEMENTS",SELECT_AGREEMENT_TYPE:"SELECT_AGREEMENT_TYPE",SET_SUBSCRIPTION:"SET_SUBSCRIPTION",SET_SELECTED_ACCOUNT:"SET_SELECTED_ACCOUNT",SET_DISPLAY_ERROR:"SET_DISPLAY_ERROR",SET_LICENSES:"SET_LICENSES",SET_TOASTER:"SET_TOASTER",CHECK_LICENSE:"CHECK_LICENSE",SELECT_ASSET_SIZE:"SELECT_ASSET_SIZE",SET_CTA_IN_PROGRESS:"SET_CTA_IN_PROGRESS",SELECT_PRICING_CLARITY_OPTION_TOGGLE:"SELECT_PRICING_CLARITY_OPTION_TOGGLE",GO_TO_BEGINNING:"GO_TO_BEGINNING",GO_TO_FREE_ADMIN_DOWNLOAD:"GO_TO_FREE_ADMIN_DOWNLOAD",GO_TO_CONFIRM_DOWNLOAD:"GO_TO_CONFIRM_DOWNLOAD",GO_TO_COMPLETE_DOWNLOAD:"GO_TO_COMPLETE_DOWNLOAD",GO_TO_NEXT_STEP:"GO_TO_NEXT_STEP",FETCH_USER_AGREEMENT_OVERVIEW_RESPONDED:"FETCH_USER_AGREEMENT_OVERVIEW_RESPONDED",SET_REDIRECT_BEFORE_INITIATING_DOWNLOAD:"SET_REDIRECT_BEFORE_INITIATING_DOWNLOAD",POST_ASSET_TO_CREATE_DOWNLOAD:"POST_ASSET_TO_CREATE_DOWNLOAD",REDIRECT_TO_URL:"REDIRECT_TO_URL",SET_DOWNLOAD_DATA:"SET_DOWNLOAD_DATA",SELECT_ACCOUNT_STEP:"SELECT_ACCOUNT_STEP",CONFIRM_DOWNLOAD_STEP:"CONFIRM_DOWNLOAD_STEP",GO_TO_INITIATE_DOWNLOAD_AND_SELECT_LICENSES_STEP:"GO_TO_INITIATE_DOWNLOAD_AND_SELECT_LICENSES_STEP",SET_SPECTRUM_DOWNLOADED_ASSET_ID:"SET_SPECTRUM_DOWNLOADED_ASSET_ID"}})}.call(this),function(){this.IStockDownload.factory("agreementTypes",function(){var e,t,n;return n="RoyaltyFreeSubscription",e="CreditPack",t="EasyAccess",{ROYALTY_FREE_SUBSCRIPTION:n,CREDIT_PACK:e,EASY_ACCESS:t,ALL:[n,e,t]}})}.call(this),function(){this.IStockDownload.factory("assetCollectionNames",function(){var e,t,n,i;return t="signature",e="essentials",i=function(e){return!!(null!=e?e.match(/signature/i):void 0)},n=function(e){return!!(null!=e?e.match(/essentials/i):void 0)},{SIGNATURE:t,ESSENTIALS:e,isSignature:i,isEssentials:n,getAssetCollectionName:function(n){return i(n.istockCollection)?t:e}}})}.call(this),function(){this.IStockDownload.factory("stateSteps",function(){return{PICK_PAYMENT_OPTION:"PICK_PAYMENT_OPTION",PICK_PRICING_CLARITY_PAYMENT_OPTION:"PICK_PRICING_CLARITY_PAYMENT_OPTION",FREE_ADMIN_DOWNLOAD:"FREE_ADMIN_DOWNLOAD",INITIATE_DOWNLOAD_AND_SELECT_LICENCES_STEP:"INITIATE_DOWNLOAD_AND_SELECT_LICENCES_STEP",PURCHASE_AND_SELECT_LICENCES_STEP:"PURCHASE_AND_SELECT_LICENCES_STEP",CONFIRM_DOWNLOAD_WITH_EXTENDED_LICENSES_PAID_BY_CREDITS:"CONFIRM_DOWNLOAD_WITH_EXTENDED_LICENSES_PAID_BY_CREDITS",CONFIRM_DOWNLOAD_BY_CREDITS_SINCE_SUBSCRIPTION_HAS_INSUFFICIENT_DOWNLOADS_REMAINING:"CONFIRM_DOWNLOAD_BY_CREDITS_SINCE_SUBSCRIPTION_HAS_INSUFFICIENT_DOWNLOADS_REMAINING",CONFIRM_DOWNLOAD_OF_SIGNATURE_IMAGE_BY_CREDITS_SINCE_SUBSCRIPTION_IS_FOR_ESSENTIALS:"CONFIRM_DOWNLOAD_OF_SIGNATURE_IMAGE_BY_CREDITS_SINCE_SUBSCRIPTION_IS_FOR_ESSENTIALS",CONFIRM_DOWNLOAD_BY_CREDITS_WHEN_NO_SUBSCRIPTION_EXISTS:"CONFIRM_DOWNLOAD_BY_CREDITS_WHEN_NO_SUBSCRIPTION_EXISTS",CONIFRM_DOWNLOAD_BY_CREDITS_WITH_NOTICE_THAT_FILE_UNSUPPORTED_BY_SUBSCRIPTION:"CONIFRM_DOWNLOAD_BY_CREDITS_WITH_NOTICE_THAT_FILE_UNSUPPORTED_BY_SUBSCRIPTION",CONFIRM_DOWNLOAD_BY_SUBSCRIPTION_WITH_SUFFICIENT_DOWNLOADS_REMAINING:"CONFIRM_DOWNLOAD_BY_SUBSCRIPTION_WITH_SUFFICIENT_DOWNLOADS_REMAINING",CONFIRM_DOWNLOAD_BY_SUBSCRIPTION_SINCE_INSUFFICIENT_CREDITS_REMAINING:"CONFIRM_DOWNLOAD_BY_SUBSCRIPTION_SINCE_INSUFFICIENT_CREDITS_REMAINING",CONFIRM_DOWNLOAD_BY_TEAM_CREDITS:"CONFIRM_DOWNLOAD_BY_TEAM_CREDITS",CONFIRM_REDOWNLOAD_FOR_FREE:"CONFIRM_REDOWNLOAD_FOR_FREE",MUST_BUY_CREDITS_FOR_FILE_UNSUPPORTED_BY_SUBSCRIPTION:"MUST_BUY_CREDITS_FOR_FILE_UNSUPPORTED_BY_SUBSCRIPTION",MUST_BUY_CREDITS_WHEN_INSUFFICIENT_REMAINING_AND_NO_SUBSCRIPTION:"MUST_BUY_CREDITS_WHEN_INSUFFICIENT_REMAINING_AND_NO_SUBSCRIPTION",MUST_BUY_CREDITS_WHEN_INSUFFICIENT_REMAINING_AND_SUBSCRIPTION_IS_FOR_ESSENTIALS:"MUST_BUY_CREDITS_WHEN_INSUFFICIENT_REMAINING_AND_SUBSCRIPTION_IS_FOR_ESSENTIALS",MUST_BUY_CREDITS_WHEN_INSUFFICIENT_REMAINING_AND_SUBSCRIPTION_HAS_INSUFFICIENT_DOWNLOADS_REMAINING:"MUST_BUY_CREDITS_WHEN_INSUFFICIENT_REMAINING_AND_SUBSCRIPTION_HAS_INSUFFICIENT_DOWNLOADS_REMAINING",MUST_BUY_CREDITS_WHEN_INSUFFICIENT_REMAIN_TO_BUY_EXTENDED_LICENSES:"MUST_BUY_CREDITS_WHEN_INSUFFICIENT_REMAIN_TO_BUY_EXTENDED_LICENSES",TEAM_MEMBER_MUST_ASK_TEAM_ADMIN_TO_GRANT_MORE_CREDITS:"TEAM_MEMBER_MUST_ASK_TEAM_ADMIN_TO_GRANT_MORE_CREDITS",COMPLETE_DOWNLOAD:"COMPLETE_DOWNLOAD",CHOOSE_ACCOUNT:"CHOOSE_ACCOUNT",TEAM_ACCOUNT_OUT_OF_CREDITS:"TEAM_ACCOUNT_OUT_OF_CREDITS",SELECT_ACCOUNT_TYPE:"SELECT_ACCOUNT_TYPE"}})}.call(this),function(){this.IStockDownload.factory("checkLicenseReducer",["stateSteps","hasSelectedOptionalLicenses","setCalculatedTotalCostReducer","goToInitiateDownloadAndSelectLicensesStepReducer","goToPurchaseAndSelectLicensesStepReducer",function(e,t,n,i,r){return function(e,o){var c;return c=e.licenses.getIn([o.licenseIndex,"is_selected"]),e=e.setIn(["licenses",o.licenseIndex,"is_selected"],!c),e=e.setIn(["calc","hasSelectedOptionalLicenses"],t(e)),e=n(e),e.calc.step.viewLicenseSelection&&(e=e.calc.isInPricingClarity?r(e):i(e)),e}}])}.call(this),function(){this.IStockDownload.factory("setCtaInProgressReducer",function(){return function(e,t){return e=e.setIn(["calc","ctaInProgress"],t.inProgress)}})}.call(this),function(){var e=[].slice;this.IStockDownload.factory("nextStepReducer",["accountTypes","setSelectedAgreementTypeReducer",function(t,n){var i,r,o;return i={title:null,ctaClass:"",ctaTitle:null,ctaAction:"",showPricingClarity:!1,reasonForBox:"",creditsAvailable:!0,subsAvailable:!0,selectedAccount:void 0,viewLicenseSelection:!1},r=function(e){return e.calc.step.selectedAccount===t.TEAM},o=function(e){return e.calc.step.showSubTypeMessage},function(){var t,c,a,s,l,u;return l=arguments[0],t=arguments[1],c=3<=arguments.length?e.call(arguments,2):[],s=o(l)&&!r(l),a=Object.assign.apply(Object,[{},i,t,{showSubTypeMessage:s}].concat(e.call(c))),u=DeepRecord.fromJS(a),l=l.setIn(["calc","step"],u),l=n(l,{agreementType:l.calc.selectedAgreementType||u.selectedAgreementType})}}])}.call(this),function(){this.IStockDownload.factory("resetSelectedAccountReducer",["setSelectedAccountReducer",function(e){return function(t){return e(t,void 0)}}])}.call(this),function(){this.IStockDownload.factory("selectAssetSizeReducer",["setAgreementSizeReducer",function(e){var t,n;return t=function(e,t){var n;return t?(n=new RegExp("^"+t+"$","i"),e.find(function(e){var t;return null!=(t=e.teeShirtSize)?t.match(n):void 0})):null},n=function(e,n){var i,r,o;return o=e.sizes,e.hasEpsFileSize?t(o,n.preferredEpsDownloadSize)||o.get(e.epsFileSizeIndex):(null!=(r=o.last())?r.epsUnavailable:void 0)?(i=o.pop(),t(o,n.preferredDownloadSize)||i.last()):t(o,n.preferredDownloadSize)||o.last()},function(t,i){var r,o,c;return r=i.assetSize,c=r,o=!r&&t.calc.assetIsImage,o&&(c=n(t.asset,i)),t=t.setIn(["calc","selectedAssetSize"],c),t=e(t)}}])}.call(this),function(){this.IStockDownload.factory("setAgreementSizeReducer",["agreementTypes","hasSelectedOptionalLicenses",function(e,t){var n,i,r,o,c,a,s,l,u,d;return s=function(e){var t,i,r;return i=u(e),t=null!=(r=e.calc.selectedAssetSize)?r.get(i):void 0,t?n(t):d},n=function(e){var t;return t=new RegExp("^"+e+"$","i"),function(e,n){return n.reduce(function(n,i){var r;return n||null!=(null!=(r=e[i])?r.match(t):void 0)},!1)}},d=function(){return!1},u=function(e){return e.calc.assetIsImage||e.calc.assetIsIllustration?"teeShirtSize":e.calc.assetIsVideo?"name":null},l=function(e){var t;return t=[],e.calc.assetIsImage&&t.push("tee_shirt_size"),(e.calc.assetIsIllustration||e.calc.assetIsVideo)&&t.push("teams_size"),t},a=function(e){var t,n;return n=s(e),t=l(e),e.calc.selectedAgreement.authorized_sizes.find(function(e){return n(e,t)})},c=function(t){var n,i,r,c,a;return c=s(t),i=l(t),a=t.agreements.filter(function(t){return t.type===e.ROYALTY_FREE_SUBSCRIPTION}),n=o(a,i,c),n||(r=t.agreements.filter(function(t){return t.type===e.CREDIT_PACK}),n=o(r,i,c)),n},o=function(e,t,n){return e.flatMap(function(e){return e.authorized_sizes}).find(function(e){return e.is_free&&n(e,t)})},i=function(t){var n,i,o;return i=s(t),n=l(t),o=t.agreements.filter(function(t){return t.type===e.EASY_ACCESS}),r(o,n,i)},r=function(e,t,n){return e.flatMap(function(e){return e.authorized_sizes}).find(function(e){return n(e,t)})},function(e){var n;return n=void 0,e.calc.redownloadForFree&&!t(e)?n=c(e)||e.calc.selectedAgreementSize:e.calc.isFreeAdminDownload?n=i(e)||e.calc.selectedAgreementSize:e.calc.selectedAgreement&&(n=a(e)),e=e.setIn(["calc","selectedAgreementSize"],n)}}])}.call(this),function(){this.IStockDownload.factory("setAgreementsReducer",["agreementTypes","setAgreementSizeReducer",function(e,t){var n,i,r,o;return n=function(t){var n,i;return n=t.find(function(t){return t.type===e.CREDIT_PACK&&t.agreement_details.is_credit_share}),(null!=n&&null!=(i=n.agreement_details)?i.available_credits:void 0)||0},i=function(e){return!!e.find(function(e){return e.authorized_sizes.find(function(e){return e.is_free})})},r=function(e,t){return e.filter(function(e){return e.type===t})},o=function(e,t){return!!r(e,t)[0]},function(r,c){var a;return a=c.agreements||[],r=r.set("agreements",DeepRecord.fromJS(a)),r=r.mergeIn(["calc"],{includedWithSubscription:o(a,e.ROYALTY_FREE_SUBSCRIPTION),redownloadForFree:i(a),isFreeAdminDownload:o(a,e.EASY_ACCESS),teamCreditsAvailable:n(a)}),r=t(r)}}])}.call(this),function(){this.IStockDownload.factory("setAvailableCreditsReducer",["setSelectedAccountReducer",function(e){return function(t,n){return t=t.mergeIn(["user"],{credit_amount:Math.max(0,n.personalCredits||0),team_credits:Math.max(0,n.teamCredits||0)}),t=e(t,{selectedAccountName:t.calc.selectedAccount})}}])}.call(this),function(){this.IStockDownload.factory("setCalculatedHasSubscriptionReducer",function(){return function(e,t){var n;return n=t.subscription.isEssentials||t.subscription.isSignature,e=e.mergeIn(["calc"],{hasSubscription:n,isSubscriptionDownloadAllowed:n&&t.includedWithSubscription&&t.subscription.downloadsRemaining>0})}})}.call(this),function(){this.IStockDownload.factory("setCalculatedTotalCostReducer",["setSelectedAccountHasEnoughCreditsReducer",function(e){var t,n,i;return i=function(e){return e.licenses.filter(function(e){return e.is_selected&&!e.is_acquired_and_not_repurchasable})},t=function(e,t){return e+t.credit_cost},n=function(e){return e.reduce(t,0)},function(t){var r;return r=i(t),t=t.mergeIn(["calc"],{totalCreditCost:n(r),notAcquiredSelectedLicenses:r}),t=e(t)}}])}.call(this),function(){this.IStockDownload.factory("setDisplayErrorReducer",function(){return function(e,t){return e=e.set("displayError",t.message)}})}.call(this),function(){this.IStockDownload.factory("setDownloadDataReducer",function(){return function(e,t){var n,i,r,o,c,a;return n=t.downloadData,e=e.set("downloadData",DeepRecord.fromJS({data:n,hasDownloadDestinations:0<(null!=(i=n.download_destinations)?i.length:void 0),downloadDestinationUrl:null!=(r=n.single_downloads)&&null!=(o=r[0])?o.url:void 0,dropboxEnabled:!!(null!=(c=n.download_destinations)&&null!=(a=c[0])?a.token:void 0)}))}})}.call(this),function(){this.IStockDownload.factory("setLargestSizeAvailableReducer",function(){var e;return e=function(e){var t,n,i;return i=e.sizes,e.hasEpsFileSize?i.get(e.epsFileSizeIndex):(null!=(n=i.last())?n.epsUnavailable:void 0)?(t=i.pop(),t.last()):i.last()},function(t){var n;return t.calc.assetIsImage&&(n=e(t.asset)),t=t.setIn(["calc","largestSizeAvailable"],n)}})}.call(this),function(){this.IStockDownload.factory("setLicensesReducer",["hasSelectedOptionalLicenses","setCalculatedTotalCostReducer","goToInitiateDownloadAndSelectLicensesStepReducer","goToPurchaseAndSelectLicensesStepReducer",function(e,t,n,i){var r;return r=function(e){return e.map(function(e,t){return"Standard"!==e.license_type?t:null}).filter(function(e){return null!==e})},function(o,c){var a;return a=c.licenses||[],o=o.set("licenses",DeepRecord.fromJS(a)),o=o.setIn(["calc","optionalLicenseIndexes"],DeepRecord.fromJS(r(a))),o=o.setIn(["calc","hasSelectedOptionalLicenses"],e(o)),o=t(o),o=o.calc.isInPricingClarity?i(o):n(o)}}])}.call(this),function(){this.IStockDownload.factory("setRedirectBeforeInitiatingDownloadReducer",function(){return function(e){return e.user.authenticated||!e.user.remembered&&!e.asset.freeFile||(e=e.set("redirectToUrl","/sign-in?returnurl="+window.location.pathname+window.location.search)),e}})}.call(this),function(){this.IStockDownload.factory("setRedirectUrlReducer",function(){return function(e,t){return e=e.set("redirectToUrl",t.url)}})}.call(this),function(){this.IStockDownload.factory("setSelectedAccountReducer",["accountTypes","agreementTypes","setSelectedAccountHasEnoughCreditsReducer","setSelectedAgreementTypeReducer",function(e,t,n,i){var r;return r=function(e){var n;return n=void 0,e.calc.isTeamAccountSelected&&e.calc.selectedAccountHasEnoughCredits&&(n=t.CREDIT_PACK),i(e,{agreementType:n})},function(t,i){var o,c,a;return null==i&&(i=void 0),c=null!=i?i.selectedAccountName:void 0,a=null,o=c===e.TEAM||!!t.user.team_leader,o?a=t.calc.teamCreditsAvailable:c===e.PERSONAL&&(a=t.user.credit_amount),t=t.mergeIn(["calc"],{selectedAccount:c,selectedAccountCredits:a,selectedAccountHasAnyCredits:0<a,isTeamAccountSelected:o}),t=n(t),t=r(t)}}])}.call(this),function(){this.IStockDownload.factory("setSelectedAccountHasEnoughCreditsReducer",function(){return function(e){var t;return t=e.calc.totalCreditCost<=e.calc.selectedAccountCredits,e=e.setIn(["calc","selectedAccountHasEnoughCredits"],t)}})}.call(this),function(){this.IStockDownload.factory("setSelectedAgreementReducer",["agreementTypes","setAgreementSizeReducer",function(e,t){var n,i,r,o;return i=function(e){return e.asset.freeFile?e.agreements.first():null},function(e){return!!e.agreement_details.is_credit_share},function(e){return!!e.agreement_details.is_shared_subscription},n=function(){return!0},r=function(e){return e.agreements.find(function(t){return t.type===e.calc.selectedAgreementType&&(n(e,t)||e.user.team_leader)})},o=function(e){return i(e)||r(e)},function(e){return e=e.setIn(["calc","selectedAgreement"],o(e)),e=t(e)}}])}.call(this),function(){this.IStockDownload.factory("setSelectedAgreementTypeReducer",["agreementTypes","setSelectedAgreementReducer",function(e,t){var n;return n=function(t,n){return n===e.ROYALTY_FREE_SUBSCRIPTION?t.calc.step.subsAvailable:n===e.CREDIT_PACK&&t.calc.step.creditsAvailable},function(e,i){var r;return r=(null!=i?i.agreementType:void 0)||e.calc.selectedAgreementType,e=e.setIn(["calc","selectedAgreementType"],n(e,r)?r:null),e=t(e)}}])}.call(this),function(){this.IStockDownload.factory("setSubscriptionReducer",["setCalculatedHasSubscriptionReducer",function(e){return function(t,n){return t=t.mergeIn(["user","subsInfo"],DeepRecord.fromJS(n)),t=e(t,{subscription:n,includedWithSubscription:t.calc.includedWithSubscription})}}])}.call(this),function(){this.IStockDownload.factory("setToasterReducer",function(){var e;return e=function(e){var t,n,i,r;return i=e.forceDownload,t=e.dropboxEnabled,r=e.incentivizationModal,n=null!=giLocalStorage.getItem("dropboxOptOut"),!(i||t||n||r)},function(t,n){return t=t.mergeIn(["calc"],{showDropboxModal:e(n),showIncentivizationModal:n.incentivizationModal})}})}.call(this),function(){this.IStockDownload.factory("togglePricingClarityOptionReducer",["pickPricingClarityPaymentOptionStepReducer",function(e){return function(t){return t=e(t,{togglePricingOption:!0})}}])}.call(this),function(){this.IStockDownload.factory("uncheckAllOptionalLicencesReducer",["setCalculatedTotalCostReducer",function(e){return function(t){var n;return n=t.licenses.withMutations(function(e){return t.calc.optionalLicenseIndexes.forEach(function(t){return e.setIn([t,"is_selected"],!1)})}),t=t.set("licenses",n),t=t.setIn(["calc","hasSelectedOptionalLicenses"],!1),t=e(t),t=t.setIn(["calc","step","viewLicenseSelection"],!1)}}])}.call(this),function(){this.IStockDownload.factory("hasSelectedOptionalLicenses",["optionalLicenses",function(e){return function(t){return e(t).reduce(function(e,t){return e||t.is_selected},!1)}}])}.call(this),
function(){this.IStockDownload.factory("reducerHelpers",["agreementTypes","t","confirmDownloadTracking",function(e,t,n){var i,r,o,c,a,s,l,u,d,_,S,f,p,T,I,E,A,C,h;return C=function(e){var t,n;return n=e.calc.selectedAccountCredits,t=e.calc.totalCreditCost,1===t?"insf_one_credit_cost":1===n?"insf_one_credit":"insf_credits"},T=function(e){var t,n;return t=e.calc.assetIsVideo?"video_":"image_",n=C(e),""+t+n},p=function(e){return t(T(e),{zero:"<strong>",one:"</strong>",two:"<strong>",three:"</strong>",credit_cost:e.calc.totalCreditCost,greaterthan1_credit_balance:e.calc.selectedAccountCredits})},d=t("free_download_cta"),S=t("download_this_video_clip"),_=t("download_this_image"),A=function(e){return e.asset.freeFile?d:e.calc.assetIsVideo?S:_},u="PLACEHOLDER",l=t("confirm_download"),s="primary-cta",a="createDownload",f=function(t){return{name:u,title:null,ctaTitle:l,ctaClass:s,ctaAction:a,showCreditCost:!0,confirmSection:!t.calc.step.viewLicenseSelection,selectedAgreementType:e.CREDIT_PACK,isConfirmationState:!0,subsAvailable:!0,triggerTracking:n(t.user.subsInfo,t.user.team_leader,t.user.team_member,t.calc,l)}},E=function(e){return{showDownloadChoices:!0,showSubscriptionField:e.calc.hasSubscription,subTitleTranslation:e.calc.assetCollectionName+"_subscription",subDownloadsTranslationValue:e.user.subsInfo.downloadsRemaining}},c="PLACEHOLDER_BUY_CREDITS_NAME",o=t("buy_credits"),r="primary-cta",i="redirectToPricing",I=function(){return{name:c,ctaTitle:o,ctaClass:r,ctaAction:i}},h=function(e){return e.user.team_member&&e.calc.isTeamAccountSelected},{buildInsufficientCreditsHtmlTranslation:p,defaultCtaTitle:A,buildConfirmDownloadPaidByCreditsStep:f,buildMustBuyStep:I,buildStepDetailsToShowDownloadChoices:E,isUsingTeamAccount:h}}])}.call(this),function(){this.IStockDownload.factory("optionalLicenses",function(){return function(e){return e.calc.optionalLicenseIndexes.map(function(t){return e.licenses.get(t)})}})}.call(this),function(){this.IStockDownload.factory("fetchUserAgreementsOverviewRespondedReducer",["actionTypes","assetCollectionNames","setAvailableCreditsReducer","setSubscriptionReducer","plansAndPricingUrlService",function(e,t,n,i,r){var o,c;return o=function(e){var n,i,r;return r=e.name||"",i=e.download_count||0,n=e.download_limit||0,{isSignature:t.isSignature(r),isEssentials:t.isEssentials(r),downloadedCount:i,downloadLimit:n,downloadsRemaining:n-i,autoRenews:!!e.is_auto_renewal,daysUntilExpiry:e.days_until_product_expires||0}},c=function(e){var t;return t=!e.asset.freeFile&&!e.calc.redownloadForFree,!t||e.user.team_member||e.calc.selectedAccountHasAnyCredits||e.calc.hasSubscription||(e=e.set("redirectToUrl",r.getPricingRoute(e.calc.assetIsVideo))),e},function(e,t){var r,a,s,l,u;return r=t.agreementOverview||{},null!=(null!=(a=r.credit_pack_agreement)?a.credits_available:void 0)&&(e=n(e,{personalCredits:r.credit_pack_agreement.credits_available||0})),(null!=(s=r.royalty_free_subscription_agreements)?s.length:void 0)>0&&(l=r.royalty_free_subscription_agreements[0],null!=l.download_count&&null!=l.download_limit&&null!=l.name&&(u=o(l),e=i(e,u))),e=c(e)}}])}.call(this),function(){this.IStockDownload.factory("goToConfirmDownloadAndSelectLicensesPaidByCreditsStepReducer",["reducerHelpers","stateSteps","nextStepReducer",function(e,t,n){return function(i){return n(i,e.buildConfirmDownloadPaidByCreditsStep(i),{name:t.CONFIRM_DOWNLOAD_WITH_EXTENDED_LICENSES_PAID_BY_CREDITS,viewLicenseSelection:!0})}}])}.call(this),function(){this.IStockDownload.factory("confirmDownloadByTeamCreditsStepReducer",["reducerHelpers","stateSteps","nextStepReducer","accountTypes","agreementTypes","t",function(e,t,n,i,r,o){var c;return c=void 0,function(a){return c=c||o("confirm_download_team_account",{team_name:a.user.team_name}),n(a,e.buildConfirmDownloadPaidByCreditsStep(a),{name:t.CONFIRM_DOWNLOAD_BY_TEAM_CREDITS,title:c,confirmSection:!0,showTshirtSizes:!1,showCreditCost:!0,showSubTypeMessage:!1,showFileTypeDropdown:!1,selectedAgreementType:r.CREDIT_PACK,isConfirmationState:!0,selectedAccount:i.TEAM})}}])}.call(this),function(){this.IStockDownload.factory("confirmDownloadByCreditsWhenNoSubscriptionExistsStepReducer",["reducerHelpers","stateSteps","nextStepReducer",function(e,t,n){return function(i){return n(i,e.buildConfirmDownloadPaidByCreditsStep(i),{name:t.CONFIRM_DOWNLOAD_BY_CREDITS_WHEN_NO_SUBSCRIPTION_EXISTS,title:void 0,focusView:!0,paymentSelect:!0})}}])}.call(this),function(){this.IStockDownload.factory("confirmDownloadOfSignatureImageByCreditsSinceSubscriptionIsForEssentialsStepReducer",["reducerHelpers","stateSteps","nextStepReducer","t",function(e,t,n,i){var r,o;return o=void 0,r=i("image_only_with_sig_or_credits"),function(c){return o=o||i(c.calc.assetCollectionName+"_download"),n(c,e.buildConfirmDownloadPaidByCreditsStep(c),{name:t.CONFIRM_DOWNLOAD_OF_SIGNATURE_IMAGE_BY_CREDITS_SINCE_SUBSCRIPTION_IS_FOR_ESSENTIALS,title:o,reasonForBox:r,warningBox:!0,hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0,subsAvailable:!1,confirmSection:!1},e.buildStepDetailsToShowDownloadChoices(c))}}])}.call(this),function(){this.IStockDownload.factory("confirmDownloadByCreditsSinceSubscriptionHasInsufficientDownloadsRemainingStepReducer",["reducerHelpers","stateSteps","nextStepReducer","t",function(e,t,n,i){var r,o;return o=void 0,r=void 0,function(c){return o=o||i(c.calc.assetCollectionName+"_download"),r=r||i("look_no_downloads_"+c.calc.assetCollectionName),n(c,e.buildConfirmDownloadPaidByCreditsStep(c),{name:t.CONFIRM_DOWNLOAD_BY_CREDITS_SINCE_SUBSCRIPTION_HAS_INSUFFICIENT_DOWNLOADS_REMAINING,title:o,reasonForBox:r,warningBox:!0,hideDetails:!0,showDownloadChoices:!0,showCreditCost:!1,confirmSection:!1,subsAvailable:!1},e.buildStepDetailsToShowDownloadChoices(c))}}])}.call(this),function(){this.IStockDownload.factory("confirmDownloadByCreditsWithNoticeThatFileUnsupportedBySubscriptionStepReducer",["reducerHelpers","stateSteps","nextStepReducer","t",function(e,t,n,i){var r;return r=void 0,function(o){return r=r||i(o.calc.assetCollectionName+"_download"),n(o,e.buildConfirmDownloadPaidByCreditsStep(o),{name:t.CONIFRM_DOWNLOAD_BY_CREDITS_WITH_NOTICE_THAT_FILE_UNSUPPORTED_BY_SUBSCRIPTION,title:r,warningBox:!0,reasonForBox:i("video_only_with_credits"),hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0,subsAvailable:!1,confirmSection:!1},e.buildStepDetailsToShowDownloadChoices(o))}}])}.call(this),function(){this.IStockDownload.factory("confirmDownloadBySubscriptionSinceInsufficientCreditsRemainingStepReducer",["reducerHelpers","stateSteps","nextStepReducer","agreementTypes","t",function(e,t,n,i,r){var o;return o=void 0,function(c){return o=o||r(c.calc.assetCollectionName+"_download"),n(c,e.buildConfirmDownloadPaidByCreditsStep(c),{name:t.CONFIRM_DOWNLOAD_BY_SUBSCRIPTION_SINCE_INSUFFICIENT_CREDITS_REMAINING,title:o,hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0,selectedAgreementType:i.ROYALTY_FREE_SUBSCRIPTION,showCreditCost:!1,creditsAvailable:!1},e.buildStepDetailsToShowDownloadChoices(c))}}])}.call(this),function(){this.IStockDownload.factory("confirmDownloadBySubscriptionWithSufficientDownloadsRemainingStepReducer",["reducerHelpers","stateSteps","nextStepReducer","agreementTypes","confirmDownloadTracking","t",function(e,t,n,i,r,o){var c,a,s,l,u;return u=function(e){var t,n;return n=e.calc.includedWithSubscription,t=e.calc.assetIsVideo,{showSubTypeMessage:n&&!t,showCreditCost:!n||t}},l=void 0,s=o("confirm_download"),a="primary-cta",c="createDownload",function(e){return l=l||o(e.calc.assetCollectionName+"_download"),n(e,{name:t.CONFIRM_DOWNLOAD_BY_SUBSCRIPTION_WITH_SUFFICIENT_DOWNLOADS_REMAINING,title:l,ctaTitle:s,ctaClass:a,ctaAction:c,confirmSection:!0,isConfirmationState:!0,selectedAgreementType:i.ROYALTY_FREE_SUBSCRIPTION,triggerTracking:r(e.user.subsInfo,e.user.team_leader,e.user.team_member,e.calc,s)},u(e))}}])}.call(this),function(){this.IStockDownload.factory("chooseAccountStepReducer",["reducerHelpers","stateSteps","nextStepReducer","setSelectedAccountReducer","accountTypes","chooseAccountTracking","t",function(e,t,n,i,r,o,c){var a,s,l,u;return u=void 0,l=c("choose_account"),s="primary-cta",a="handleAccountSelection",function(e,d){return null==d&&(d={}),u=u||c(e.calc.assetCollectionName+"_collection"),e=n(e,{name:t.CHOOSE_ACCOUNT,title:u,ctaTitle:l,ctaClass:s,selectedAccount:r.TEAM,ctaAction:d.nextStepIsToDownloadWithLicenseSelection?"goToInitiateDownloadAndSelectLicensesStep":a,showAccountChoices:!0,hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0,triggerTracking:o(e.calc.selectedAccount)}),e=i(e,{selectedAccountName:e.calc.step.selectedAccount})}}])}.call(this),function(){this.IStockDownload.factory("completeDownloadStepReducer",["reducerHelpers","stateSteps","nextStepReducer","t",function(e,t,n,i){var r,o;return o=function(e){var t,n;return n=e.calc.includedWithSubscription,t=e.calc.assetIsVideo,{showCreditCost:!n||t}},r=i("download_complete"),function(e,i){return n(e,{name:t.COMPLETE_DOWNLOAD,title:r,ctaTitle:null,ctaClass:"adp-purchase-complete-btn",ctaAction:"createDownload",confirmSection:!1,completeSection:!0,showTshirtSizes:!1,showSubTypeMessage:!1,showFileTypeDropdown:!1,purchaseExtendedLicenseNotAllowed:!0,dropboxEnabled:i.dropboxEnabled},o(e))}}])}.call(this),function(){this.IStockDownload.factory("confirmRedownloadForFreeStepReducer",["reducerHelpers","stateSteps","nextStepReducer","agreementTypes","t",function(e,t,n,i,r){var o,c;return c=r("re_download_for_free"),o=r("confirm_download"),function(e){return n(e,{name:t.CONFIRM_REDOWNLOAD_FOR_FREE,title:c,ctaTitle:o,ctaClass:"primary-cta",ctaAction:"createDownload",confirmSection:!1,redownloadSection:!0,showExtendedLicenses:!1,showSubTypeMessage:!1,showFileTypeDropdown:!1,isConfirmationState:!0,triggerTracking:function(){var t,n,r,c,a,l,u,d,_,S,f,p,T,I,E,A,C,h;if("undefined"==typeof s||null===s)return!1;if(r=window.tracking_data.asset_details,A={downloadedCount:e.user.subsInfo.downloadedCount,remainingCount:e.user.subsInfo.downloadsRemaining,daysUntilExpiry:e.user.subsInfo.daysUntilExpiry,autoRenews:e.user.subsInfo.autoRenew},c=A.autoRenews?"on":"off",t=e.calc.selectedAgreementType===i.CREDIT_PACK,l=e.calc.totalCreditCost,d=e.calc.redownloadForFree,_=e.user.team_leader,S=e.calc.userIsTeamUser,C=e.user.team_member&&e.calc.isTeamAccountSelected,n=t&&0===l,t=t&&!n,s.linkTrackEvents="event4",s.events="event4",p="events,products,prop7,eVar7,eVar13,eVar39,prop39,prop56,prop59,eVar62",s.eVar13=$.AssetDetail.Tracking.eVar13(r),s.prop39=s.eVar39=null!=(I=window.giLocalStorage)?I.getItem("target_search_mix"):void 0,s.prop56=r.asset_id,s.prop59="adp|download",n||d?(s.products=";;;;event23=0;;",s.linkTrackEvents+=",event23,event33",s.events+=",event23,event33",d&&(p+=",eVar62",s.eVar62="redownload")):t?(s.products=";;;;event23="+l+";;",s.linkTrackEvents+=",event23",s.events+=",event23",p+=",eVar62",s.eVar62="Credits"):(s.products=";SUBISTOCK1M",p+=",eVar62,prop24",s.eVar62="Subscription",s.prop24=[A.remainingCount,A.downloadedCount,A.daysUntilExpiry,c].join("|")),S&&(s.eVar62+=_?" | Leader Download":" | Member Download"),S&&!_&&(window.tracking_data.download_with_team_credits=C),T=$.siteCatalyst.pageTrackingVariables(),a=$.extend({},T),p&&p.length>0)for(E=p.split(","),u=0,f=E.length;u<f;u++)h=E[u],a[h]=!0;return s.linkTrackVars=$.map(a,function(e,t){return t}).join(","),s.tl(!0,"o",o.replace(/\s/g,""))}})}}])}.call(this),function(){this.IStockDownload.factory("freeAdminDownloadStepReducer",["stateSteps","nextStepReducer","agreementTypes","freeAdminDownloadTracking","t",function(e,t,n,i,r){var o;return o=r("confirm_download"),function(r){return t(r,{name:e.FREE_ADMIN_DOWNLOAD,title:"Free admin download",ctaTitle:o,ctaClass:"primary-cta",ctaAction:"createDownload",confirmSection:!1,selectedAgreementType:n.EASY_ACCESS,triggerTracking:i(r.calc.userIsTeamUser,r.user.isTeamLeader)})}}])}.call(this),function(){this.IStockDownload.factory("goToInitiateDownloadAndSelectLicensesStepReducer",["stateSteps","reducerHelpers","nextStepReducer","goToInitiateDownloadAndSelectLicensesTracking",function(e,n,i,r){var o;return o=void 0,function(c){return o=o||t(c.calc.assetCollectionName+"_collection"),c=i(c,{name:e.INITIATE_DOWNLOAD_AND_SELECT_LICENCES_STEP,title:o,ctaTitle:n.defaultCtaTitle(c),ctaClass:"super-cta",ctaAction:"initiateDownload",showAccountChoices:!1,showCreditCost:!0,hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0,viewLicenseSelection:!0,triggerTracking:r(c.calc.userIsTeamUser,c.user.team_leader,n.defaultCtaTitle(c))})}}])}.call(this),function(){this.IStockDownload.factory("goToNextStepReducer",["accountTypes","setSelectedAccountReducer","setSelectedAgreementTypeReducer","chooseAccountStepReducer","selectAccountTypeStepReducer","goToConfirmDownloadAndSelectLicensesPaidByCreditsStepReducer","confirmDownloadByCreditsSinceSubscriptionHasInsufficientDownloadsRemainingStepReducer","confirmDownloadOfSignatureImageByCreditsSinceSubscriptionIsForEssentialsStepReducer","confirmDownloadByCreditsWhenNoSubscriptionExistsStepReducer","confirmDownloadByCreditsWithNoticeThatFileUnsupportedBySubscriptionStepReducer","confirmDownloadBySubscriptionWithSufficientDownloadsRemainingStepReducer","confirmDownloadBySubscriptionSinceInsufficientCreditsRemainingStepReducer","confirmDownloadByTeamCreditsStepReducer","confirmRedownloadForFreeStepReducer","mustBuyCreditsForFileUnsupportedBySubscriptionStepReducer","mustByCreditsWhenInsufficientRemainingAndNoSubscriptionStepReducer","mustBuyCreditsWhenInsufficientRemainingAndSubscriptionIsForEssentialsStepReducer","mustBuyCreditsWhenInsufficientRemainingAndSubscriptionHasInsufficientDownloadsRemainingStepReducer","mustBuyCreditsWhenInsufficientRemainingToBuyExtendedLicensesStepReducer","teamMemberMustAskTeamAdminToGrantMoreCreditsStepReducer","teamAccountOutOfCreditsStepReducer",function(e,t,n,i,r,o,c,a,s,l,u,d,_,S,f,p,T,I,E,A,C){var h,m;return h=function(e){return e.calc.hasSubscription&&e.calc.includedWithSubscription&&0<e.user.subsInfo.downloadsRemaining},m=function(e){return e.calc.hasSubscription&&e.calc.includedWithSubscription&&0===e.user.subsInfo.downloadsRemaining},function(n){if(!n.calc.hasSelectedOptionalLicenses){if(n.asset.freeFile)return u(n);if(n.calc.redownloadForFree)return S(n)}if(n.user.team_member){if(!n.user.has_purchase_history)return n=t(n,{selectedAccountName:e.TEAM}),n.calc.selectedAccountHasEnoughCredits?_(n):C(n);if(!n.calc.selectedAccount)return i(n);if(n.calc.isTeamAccountSelected&&!n.calc.selectedAccountHasEnoughCredits)return C(n)}return n.calc.selectedAccount||(n=t(n,{selectedAccountName:e.PERSONAL})),n.calc.hasSelectedOptionalLicenses?n.calc.selectedAccountHasEnoughCredits?o(n):n.user.team_member&&n.calc.isTeamAccountSelected?A(n):E(n):!n.calc.hasSubscription&&n.user.team_member&&n.calc.isTeamAccountSelected&&!n.calc.selectedAccountHasEnoughCredits?C(n):n.calc.selectedAccountHasEnoughCredits&&h(n)?r(n):n.calc.selectedAccountHasEnoughCredits&&m(n)?c(n):n.calc.selectedAccountHasAnyCredits&&!n.calc.selectedAccountHasEnoughCredits&&h(n)?d(n):!n.calc.assetIsVideo&&n.calc.assetCollectionIsSignature&&n.user.subsInfo.isEssentials?n.calc.selectedAccountHasEnoughCredits?a(n):T(n):!n.calc.selectedAccountHasEnoughCredits&&m(n)?I(n):n.calc.assetIsVideo&&n.calc.hasSubscription?n.calc.selectedAccountHasEnoughCredits?n.calc.isTeamAccountSelected?s(n):l(n):f(n):n.calc.hasSubscription?n.calc.selectedAccountHasEnoughCredits||h(n)?u(n):p(n):n.calc.selectedAccountHasEnoughCredits?s(n):p(n)}}])}.call(this),function(){this.IStockDownload.factory("goToPurchaseAndSelectLicensesStepReducer",["stateSteps","reducerHelpers","nextStepReducer","goToPurchaseAndSelectLicensesTracking",function(e,n,i,r){var o;return o=void 0,function(c){return o=o||t(c.calc.assetCollectionName+"_collection"),c=i(c,{name:e.PURCHASE_AND_SELECT_LICENCES_STEP,title:o,ctaTitle:n.defaultCtaTitle(c),ctaClass:"super-cta",ctaAction:"redirectToPricing",showAccountChoices:!1,showCreditCost:!0,hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0,viewLicenseSelection:!0,triggerTracking:r(c.calc.userIsTeamUser,c.user.team_leader,n.defaultCtaTitle(c))})}}])}.call(this),function(){this.IStockDownload.factory("initializeDataStepReducer",["assetCollectionNames","setCalculatedHasSubscriptionReducer","setSelectedAccountReducer","setCalculatedTotalCostReducer","setInitialStepReducer","selectAssetSizeReducer","setLargestSizeAvailableReducer",function(e,t,n,i,r,o,c){var a,s;return a=function(e,n){var i;return i=t(Immutable.Map({calc:Immutable.Map()}),{subscription:n.subsInfo,includedWithSubscription:!1}),i.toJS().calc},s=function(e){return n(e)},function(t,n){var l,u,d,_,S,f;return l=n.asset,f=n.user,d=n.geolocation_country,_=n.preferredDownloadSize,S=n.preferredEpsDownloadSize,l.sizes=l.sizes||[],t=t.merge({asset:DeepRecord.fromJS(l),user:DeepRecord.fromJS(f),licenses:DeepRecord.fromJS([l.standardLicense])}),u=t.calc.withMutations(function(t){var n;return t.merge(a(l,f)),n=e.getAssetCollectionName(l),t.merge({assetCollectionName:e.getAssetCollectionName(l),assetCollectionIsSignature:e.isSignature(n),assetIsIllustration:"illustration"===l.mediaType,assetIsImage:"image"===l.assetType,assetIsVideo:"film"===l.assetType,assetIsEasyAccess:l.agreements.indexOf("EA")>-1,geolocation_country:d,userIsTeamUser:f.team_member||f.team_leader,hasSubscription:t.hasSubscription})}),t=t.set("calc",u),t=s(t),t=i(t),t=r(t),t=c(t),o(t,{preferredDownloadSize:_,preferredEpsDownloadSize:S})}}])}.call(this),function(){this.IStockDownload.factory("pickPaymentOptionStepReducer",["reducerHelpers","stateSteps","nextStepReducer","pickPaymentOptionTracking","t",function(e,t,n,i,r){var o,c;return c=function(e){var t,n;return n=e.calc.includedWithSubscription,t=e.calc.assetIsVideo,{showSubTypeMessage:n&&!t,showFileTypeDropdown:t,showCreditCost:!n||t}},o=void 0,function(a,s){return null==s&&(s={}),o=o||r(a.calc.assetCollectionName+"_collection"),n(a,{name:t.PICK_PAYMENT_OPTION,title:o,ctaClass:"super-cta",ctaTitle:e.defaultCtaTitle(a),ctaAction:"initiateDownload",showTshirtSizes:!0,confirmSection:!1,completeSection:!1,viewLicenseSelection:a.calc.step.viewLicenseSelection,triggerTracking:i(a.calc.userIsTeamUser,a.user.team_leader,e.defaultCtaTitle(a))},c(a))}}])}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};this.IStockDownload.factory("pickPricingClarityPaymentOptionStepReducer",["stateSteps","nextStepReducer","reducerHelpers","pickPricingClarityPaymentOptionTracking","t",function(t,n,i,r,o){var c,a,s,l,u,d,_,S,f,p,T,I,E,A;return u=t.PICK_PRICING_CLARITY_PAYMENT_OPTION,s="checkout",l="pricing",[s,l],a=["GBR","CAN","USA","AUS","DEU","BRA","JPN"],c=["GBR","USA","DEU","BRA","JPN"],f=function(t){var n,i;return n=a,t.user.fast_checkout_test&&(n=c),i=t.calc.geolocation_country,e.call(n,i)>=0?s:l},_=function(e){return e.fast_checkout_test?!!e.has_credits||!(!e.has_subscription||!e.has_subs_downloads):e.has_purchase_history},E=function(e){return!(e.user.disable_pricing_clarity||e.calc.assetIsVideo||e.asset.freeFile||e.user.team_member||_(e.user)||e.calc.assetIsEasyAccess||e.calc.redownloadForFree)},I=function(e){return e===l?s:l},p=function(e,t){var n,i;return i=e.calc.step.name,n=e.calc.step.pricingOption,i!==u?f(e):t.togglePricingOption?I(n):n},S=function(e){var t;return t=1===e.asset.standardLicense.credit_cost,'redirectToCheckout({cartItem: "'+(t?"oneCredit":"moreThanOneCredit")+'"})'},T=function(e,t){return t===s?{ctaTitle:i.defaultCtaTitle(e),ctaAction:S(e)}:{ctaTitle:o("download_method"),ctaAction:"redirectToPricing({chooseSubscription: true})"}},d=void 0,A=function(e,t){var i,c;return d=d||o(e.calc.assetCollectionName+"_collection"),i=p(e,t),c=T(e,i),n(e,{name:u,title:d,ctaClass:"super-cta",ctaTitle:c.ctaTitle,ctaAction:c.ctaAction,showPricingClarity:!0,showCreditCost:!0,pricingOption:i,viewLicenseSelection:e.calc.step.viewLicenseSelection,triggerTracking:r(i)})},function(e,t){return null==t&&(t={}),e=e.setIn(["calc","isInPricingClarity"],E(e)),e.calc.isInPricingClarity&&(e=A(e,t)),e}}])}.call(this),function(){this.IStockDownload.factory("selectAccountTypeStepReducer",["reducerHelpers","stateSteps","nextStepReducer","agreementTypes","t",function(e,t,n,i,r){var o,c;return c=void 0,o=r("confirm_download"),function(a){return c=c||r(a.calc.assetCollectionName+"_download"),n(a,{name:t.SELECT_ACCOUNT_TYPE,title:c,ctaTitle:o,ctaClass:"primary-cta",ctaAction:"createDownload",hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0,selectedAgreementType:i.ROYALTY_FREE_SUBSCRIPTION,isConfirmationState:!0,triggerTracking:function(){var e,t,n,r,c,l,u,d,_,S,f,p,T,I,E,A,C,h;if("undefined"==typeof s||null===s)return!1;if(n=window.tracking_data.asset_details,A={downloadedCount:a.user.subsInfo.downloadedCount,remainingCount:a.user.subsInfo.downloadsRemaining,daysUntilExpiry:a.user.subsInfo.daysUntilExpiry,autoRenews:a.user.subsInfo.autoRenew},r=A.autoRenews?"on":"off",e=a.calc.selectedAgreementType===i.CREDIT_PACK,l=a.calc.totalCreditCost,d=a.calc.redownloadForFree,_=a.user.team_leader,S=a.calc.userIsTeamUser,C=a.user.team_member&&a.calc.isTeamAccountSelected,t=e&&0===l,e=e&&!t,s.linkTrackEvents="event4",s.events="event4",p="events,products,prop7,eVar7,eVar13,eVar39,prop39,prop56,prop59,eVar62",s.eVar13=$.AssetDetail.Tracking.eVar13(n),s.prop39=s.eVar39=null!=(I=window.giLocalStorage)?I.getItem("target_search_mix"):void 0,s.prop56=n.asset_id,s.prop59="adp|download",t||d?(s.products=";;;;event23=0;;",s.linkTrackEvents+=",event23,event33",s.events+=",event23,event33",d&&(p+=",eVar62",s.eVar62="redownload")):e?(s.products=";;;;event23="+l+";;",s.linkTrackEvents+=",event23",s.events+=",event23",p+=",eVar62",s.eVar62="Credits"):(s.products=";SUBISTOCK1M",p+=",eVar62,prop24",s.eVar62="Subscription",s.prop24=[A.remainingCount,A.downloadedCount,A.daysUntilExpiry,r].join("|")),S&&(s.eVar62+=_?" | Leader Download":" | Member Download"),S&&!_&&(window.tracking_data.download_with_team_credits=C),T=$.siteCatalyst.pageTrackingVariables(),c=$.extend({},T),p&&p.length>0)for(E=p.split(","),u=0,f=E.length;u<f;u++)h=E[u],c[h]=!0;return s.linkTrackVars=$.map(c,function(e,t){return t}).join(","),s.tl(!0,"o",o.replace(/\s/g,""))}},e.buildStepDetailsToShowDownloadChoices(a))}}])}.call(this),function(){this.IStockDownload.factory("setInitialStepReducer",["resetSelectedAccountReducer","uncheckAllOptionalLicencesReducer","pickPricingClarityPaymentOptionStepReducer","pickPaymentOptionStepReducer",function(e,t,n,i){return function(r){return r=e(r),r=t(r),r=n(r),r.calc.isInPricingClarity||(r=i(r)),r}}])}.call(this),function(){this.IStockDownload.factory("teamAccountOutOfCreditsStepReducer",["reducerHelpers","stateSteps","nextStepReducer","t",function(e,t,n,i){var r;return r=i("you_need_credits"),function(i){return n(i,{name:t.TEAM_ACCOUNT_OUT_OF_CREDITS,title:r,warningBox:!0,additionalInfoHtml:e.buildInsufficientCreditsHtmlTranslation(i),showCreditCost:!0,showPromptForAdmin:!0,hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0})}}])}.call(this),function(){this.IStockDownload.factory("teamMemberMustAskTeamAdminToGrantMoreCreditsStepReducer",["reducerHelpers","stateSteps","nextStepReducer","t",function(e,t,n,i){var r;return r=i("you_need_credits"),function(i){return n(i,{name:t.TEAM_MEMBER_MUST_ASK_TEAM_ADMIN_TO_GRANT_MORE_CREDITS,title:r,warningBox:!0,additionalInfoHtml:e.buildInsufficientCreditsHtmlTranslation(i),showCreditCost:!0,showPromptForAdmin:!0,showSubTypeMessage:!1,hideDetails:!0,hideDownloadButton:!0,purchaseExtendedLicenseNotAllowed:!0})}}])}.call(this),function(){this.IStockDownload.factory("mustBuyCreditsForFileUnsupportedBySubscriptionStepReducer",["reducerHelpers","stateSteps","nextStepReducer","t",function(e,t,n,i){var r,o;return o=void 0,r=i("video_only_with_credits"),function(c){return o=o||i(c.calc.assetCollectionName+"_download"),n(c,e.buildMustBuyStep(c),{name:t.MUST_BUY_CREDITS_FOR_FILE_UNSUPPORTED_BY_SUBSCRIPTION,title:o,warningBox:!0,reasonForBox:r,additionalInfoHtml:e.buildInsufficientCreditsHtmlTranslation(c),hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0,showPromptForAdmin:e.isUsingTeamAccount(c),hideDownloadButton:e.isUsingTeamAccount(c),showCreditCost:!0})}}])}.call(this),function(){this.IStockDownload.factory("mustBuyCreditsWhenInsufficientRemainingAndSubscriptionIsForEssentialsStepReducer",["reducerHelpers","stateSteps","nextStepReducer","t",function(e,t,n,i){var r,o;return o=void 0,r=i("image_only_with_sig_or_credits"),function(c){return o=o||i(c.calc.assetCollectionName+"_collection"),n(c,e.buildMustBuyStep(c),{name:t.MUST_BUY_CREDITS_WHEN_INSUFFICIENT_REMAINING_AND_SUBSCRIPTION_IS_FOR_ESSENTIALS,title:o,showCreditCost:!0,warningBox:!0,reasonForBox:r,additionalInfoHtml:e.buildInsufficientCreditsHtmlTranslation(c),hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0,showPromptForAdmin:e.isUsingTeamAccount(c),hideDownloadButton:e.isUsingTeamAccount(c)})}}])}.call(this),function(){this.IStockDownload.factory("mustByCreditsWhenInsufficientRemainingAndNoSubscriptionStepReducer",["reducerHelpers","stateSteps","nextStepReducer","t",function(e,t,n,i){var r;return r=i("you_need_credits"),function(i){return n(i,e.buildMustBuyStep(i),{name:t.MUST_BUY_CREDITS_WHEN_INSUFFICIENT_REMAINING_AND_NO_SUBSCRIPTION,title:r,showExtendedLicenses:!1,warningBox:!0,showCreditCost:!0,additionalInfoHtml:e.buildInsufficientCreditsHtmlTranslation(i),focusView:!0,hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0,triggerTracking:function(){var e,t;return"undefined"!=typeof s&&null!==s&&(s.linkTrackEvents+=",event198",s.events+=",event198",t=$.siteCatalyst.pageTrackingVariables(),e=$.extend({},t),e.eVar62=!0,s.linkTrackVars+=$.map(e,function(e,t){return t}).join(","),i.calc.userIsTeamUser&&(s.eVar62=i.user.isTeamLeader?"Leader Download":"Member Download"),s.tl(!0,"o","Download Image"))}})}}])}.call(this),function(){this.IStockDownload.factory("mustBuyCreditsWhenInsufficientRemainingAndSubscriptionHasInsufficientDownloadsRemainingStepReducer",["reducerHelpers","stateSteps","nextStepReducer","t",function(e,t,n,i){var r,o;return o=i("out_of_downloads"),r=i("looks_like_no_downloads"),function(i){return n(i,e.buildMustBuyStep(i),{name:t.MUST_BUY_CREDITS_WHEN_INSUFFICIENT_REMAINING_AND_SUBSCRIPTION_HAS_INSUFFICIENT_DOWNLOADS_REMAINING,title:o,warningBox:!0,reasonForBox:r,additionalInfoHtml:e.buildInsufficientCreditsHtmlTranslation(i),showPromptForAdmin:e.isUsingTeamAccount(i),hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0,hideDownloadButton:e.isUsingTeamAccount(i)})}}])}.call(this),function(){this.IStockDownload.factory("mustBuyCreditsWhenInsufficientRemainingToBuyExtendedLicensesStepReducer",["reducerHelpers","stateSteps","nextStepReducer","t",function(e,t,n,i){var r;return r=i("you_need_credits"),function(i){return n(i,e.buildMustBuyStep(i),{name:t.MUST_BUY_CREDITS_WHEN_INSUFFICIENT_REMAIN_TO_BUY_EXTENDED_LICENSES,title:r,warningBox:!0,showCreditCost:!0,showSubTypeMessage:!1,additionalInfoHtml:e.buildInsufficientCreditsHtmlTranslation(i),hideDetails:!0,purchaseExtendedLicenseNotAllowed:!0})}}])}.call(this),function(){this.IStockDownload.factory("displayErrorAction",["actionTypes",function(e){return function(t){return null==t&&(t=null),{type:e.SET_DISPLAY_ERROR,message:t}}}])}.call(this),function(){this.IStockDownload.factory("fetchAgreementsAction",["actionTypes","$http","$q",function(e,t,n){var i;return i=function(t){return{type:e.SET_AGREEMENTS,agreements:t}},function(){return function(e,r){var o,c,a;return a=r().adp,o=a.agreements,c=a.asset,0!==o.count()?n.resolve(!0):r().adp.user.authenticated?t.get("/downloads/asset-agreements/"+c.assetId,{headers:{Accept:"application/json"}}).then(function(t){var r;return e(i((null!=(r=t.data)?r.agreements:void 0)||[])),n.resolve(!0)})["catch"](function(){return e(i([])),n.resolve(!1)}):(e(i([])),n.resolve(!1))}}}])}.call(this),function(){this.IStockDownload.factory("fetchLicensesAction",["actionTypes","displayErrorAction","$http",function(e,t,n){var i;return i=function(t){return{type:e.SET_LICENSES,licenses:t}},function(e,r){return function(o,c){var a;return a=c().adp.licenses.toJS(),1<a.count()?o(i(a)):n({method:"GET",url:window.siteMap.cleanRelativePath("/asset-detail/"+e.assetId+"/licenses"),params:{asset_type:e.assetType,istock_collection:e.istockCollection,credit_share:r}}).then(function(e){var t;return t=e.data||[],o(i(t))})["catch"](function(){return o(t("can_not_get_extended_licenses"))})}}}])}.call(this),function(){this.IStockDownload.factory("fetchToasterDataAction",["actionTypes","giModalService","visitorExperiences",function(e,t){var n;return n=function(t,n,i){return{type:e.SET_TOASTER,forceDownload:t,dropboxEnabled:n,incentivizationModal:i}},function(e,i){return function(r){var o,c;return c="undefined"!=typeof giLocalStorage&&null!==giLocalStorage?giLocalStorage.getItem("hideIncentivizationToaster"):void 0,o=!1,t.getIncentivization(c).then(function(e){return o=e.data.renew_coupon})["finally"](function(){return r(n(e,i,o))})}}}])}.call(this),function(){this.IStockDownload.factory("fetchUserAgreementOverviewAction",["actionTypes","displayErrorAction","$http",function(e,t,n){var i;return i=function(t){return{type:e.FETCH_USER_AGREEMENT_OVERVIEW_RESPONDED,agreementOverview:t}},function(){return function(e){return n.get("/downloads/download-agreements-overview",{headers:{Accept:"application/json"}}).then(function(t){return e(i(t.data))})["catch"](function(){return e(t("download_failed"))})}}}])}.call(this),function(){this.IStockDownload.factory("fetchUserBalanceAction",["actionTypes","displayErrorAction","$http",function(e,t,n){var i;return i=function(t,n){return{type:e.SET_AVAILABLE_CREDITS,personalCredits:t,teamCredits:n}},function(){return function(e){return n.get("/downloads/customer/credit-balances",{headers:{Accept:"application/json"}}).then(function(t){return e(i(t.data.personal_credits,t.data.team_credits))})["catch"](function(){return e(t("download_failed"))})}}}])}.call(this),function(){this.IStockDownload.factory("goToFirstStepAction",["actionTypes","fetchAgreementsAction",function(e,t){var n;return n=function(){return{type:e.GO_TO_BEGINNING}},function(){return function(e){return e(t()).then(function(){return e(n())})["catch"](function(){})}}}])}.call(this),function(){this.IStockDownload.factory("goToInitiateDownloadAndSelectLicensesStepAction",["actionTypes","pickOptionalLicensesAction",function(e,t){var n;return n=function(){return{type:e.GO_TO_INITIATE_DOWNLOAD_AND_SELECT_LICENSES_STEP}},function(){return function(e){return e(t()).then(function(){return e(n())})}}}])}.call(this),function(){this.IStockDownload.factory("goToNextStepAction",["actionTypes",function(e){return function(){return{type:e.GO_TO_NEXT_STEP}}}])}.call(this),function(){this.IStockDownload.factory("initiateDownloadAction",["actionTypes","accountTypes","fetchAgreementsAction","fetchUserBalanceAction","fetchUserAgreementOverviewAction","setSelectedAccountAction","goToNextStepAction","displayErrorAction","setSpectrumDownloadedAssetIdAction",function(e,t,n,i,r,o,c,a,s){var l,u;return u=function(){return{type:e.SET_REDIRECT_BEFORE_INITIATING_DOWNLOAD}},l=function(){return{type:e.GO_TO_FREE_ADMIN_DOWNLOAD}},function(){return function(e,d){if(e(u()),!d().adp.redirectToUrl)return e(s()),d().adp.user.team_member||e(o(t.PERSONAL)),e(n()).then(function(){return e(i()).then(function(){return d().adp.calc.isFreeAdminDownload?e(l()):e(r()).then(function(){if(!d().adp.redirectToUrl)return e(c())})})})["catch"](function(t){return console.error(t),e(a("download_failed"))})}}}])}.call(this),function(){this.IStockDownload.factory("performDownloadAction",["$http","$window","actionTypes","agreementTypes","setRedirectUrlAction","displayErrorAction","fetchToasterDataAction","TodService","performDownloadTracking",function(e,t,n,i,r,o,c,a,s){var l,u,d,_;return _=function(e){return{type:n.SET_DOWNLOAD_DATA,downloadData:e}},d=function(e){var t,n,i,r;return t=e.asset,n=e.calc,i=e.downloadData,r=n.selectedAgreementSize.toJS(),!!a.requiresTranscoding(r)&&(a.saveData(t.assetId,r.teams_size,i.single_downloads[0].url,i.single_downloads[0].tod_job_id),!0)},l=function(e){return{type:n.GO_TO_COMPLETE_DOWNLOAD,dropboxEnabled:e}},u=function(e){return e.selectedAgreementType===i.CREDIT_PACK&&e.hasSelectedOptionalLicenses?e.notAcquiredSelectedLicenses:null},function(n,i,a,S){return function(f,p){var T,I,E,A;return E=p().adp,T=E.asset,I=E.calc,e.post("/downloads/create-download",{data:{asset:{asset_id:T.assetId,asset_type:T.assetType,asset_collection:T.istockCollection},tokens:[I.selectedAgreementSize.download_token],licenses:null!=(A=u(I))?A.toJS():void 0,korrelation_id:n,credit_share:I.isTeamAccountSelected}}).then(function(e){var n,i,r;return f(_(e.data)),r=p().adp,n=r.downloadData,
null!=n.credits_remaining&&(t.tracking_data.credits_remaining=n.credits_remaining),i=!1,d(r)||(a||!n.hasDownloadDestinations?t.location.href=n.downloadDestinationUrl:i=n.dropboxEnabled),s(r),f(c(a,i,S)),f(l(i))})["catch"](function(e){return f(403===e.status?r(i):o("download_failed"))})}}}])}.call(this),function(){this.IStockDownload.factory("pickOptionalLicensesAction",["actionTypes","fetchAgreementsAction","fetchUserBalanceAction","fetchLicensesAction","displayErrorAction",function(e,t,n,i,r){var o,c;return c=function(e){return e.user.team_member&&e.user.has_purchase_history&&!e.calc.selectedAccount},o=function(){return{type:e.SELECT_ACCOUNT_STEP,nextStepIsToDownloadWithLicenseSelection:!0}},function(){return function(e,a){return e(t()).then(function(){var t;return c(a().adp)?e(n()).then(function(){return e(o())}):(t=a().adp,e(i(t.asset,t.calc.isTeamAccountSelected)))})["catch"](function(t){return console.error(t),e(r("download_failed"))})}}}])}.call(this),function(){this.IStockDownload.factory("setRedirectUrlAction",["actionTypes",function(e){return function(t){return{type:e.REDIRECT_TO_URL,url:t}}}])}.call(this),function(){this.IStockDownload.factory("setSelectedAccountAction",["actionTypes",function(e){return function(t){return{type:e.SET_SELECTED_ACCOUNT,selectedAccountName:t}}}])}.call(this),function(){this.IStockDownload.factory("setSpectrumDownloadedAssetIdAction",["actionTypes",function(e){var t;return t=function(e){var t,n;return n=new QueryBuilder,t=n.normalizeUrl(e)[1],n.parseQuery(t)[0]},function(n){return null==n&&(n=document.referrer),null!=t(n).phrase?window.giLocalStorage.setItem("spectrum.downloadAssetId",window.tracking_data.asset_details.asset_id):window.giLocalStorage.getItem("spectrum.downloadAssetId")!==window.tracking_data.asset_details.asset_id&&window.giLocalStorage.removeItem("spectrum.downloadAssetId"),{type:e.SET_SPECTRUM_DOWNLOADED_ASSET_ID}}}])}.call(this),function(){this.IStockDownload.factory("chooseAccountTracking",["$window","accountTypes",function(e,t){return function(e){return function(){var n,i;return"undefined"!=typeof s&&null!==s&&(i=$.siteCatalyst.pageTrackingVariables(),n=$.extend({},i),n.eVar77=!0,s.linkTrackVars=$.map(n,function(e,t){return t}).join(","),s.linkTrackEvents="event197",s.events="event197",s.eVar77=e===t.PERSONAL?"MyAccount":"SharedCreditAccount",s.tl(!0,"o","Choose Account"))}}}])}.call(this),function(){this.IStockDownload.factory("confirmDownloadTracking",["$window","agreementTypes",function(e,t){return function(n,i,r,o,c){return function(){var a,l,u,d,_,S,f,p,T,I,E,A,C,h,m,g,D;if("undefined"==typeof s||null===s)return!1;if(u=e.tracking_data.asset_details,m={downloadedCount:n.downloadedCount,remainingCount:n.downloadsRemaining,daysUntilExpiry:n.daysUntilExpiry,autoRenews:n.autoRenew},d=m.autoRenews?"on":"off",a=o.selectedAgreementType===t.CREDIT_PACK,S=o.totalCreditCost,p=o.redownloadForFree,T=o.userIsTeamUser,g=r&&o.isTeamAccountSelected,l=a&&0===S,a=a&&!l,s.linkTrackEvents="event4",s.events="event4",E="events,products,prop7,eVar7,eVar13,eVar39,prop39,prop56,prop59,eVar62",s.eVar13=$.AssetDetail.Tracking.eVar13(u),s.prop39=s.eVar39=null!=(C=e.giLocalStorage)?C.getItem("target_search_mix"):void 0,s.prop56=u.asset_id,s.prop59="adp|download",l||p?(s.products=";;;;event23=0;;",s.linkTrackEvents+=",event23,event33",s.events+=",event23,event33",p&&(E+=",eVar62",s.eVar62="redownload")):a?(s.products=";;;;event23="+S+";;",s.linkTrackEvents+=",event23",s.events+=",event23",E+=",eVar62",s.eVar62="Credits"):(s.products=";SUBISTOCK1M",E+=",eVar62,prop24",s.eVar62="Subscription",s.prop24=[m.remainingCount,m.downloadedCount,m.daysUntilExpiry,d].join("|")),T&&(s.eVar62+=i?" | Leader Download":" | Member Download"),T&&!i&&(window.tracking_data.download_with_team_credits=g),A=$.siteCatalyst.pageTrackingVariables(),_=$.extend({},A),E&&E.length>0)for(h=E.split(","),f=0,I=h.length;f<I;f++)D=h[f],_[D]=!0;return s.linkTrackVars=$.map(_,function(e,t){return t}).join(","),s.tl(!0,"o",c.replace(/\s/g,""))}}}])}.call(this),function(){this.IStockDownload.factory("freeAdminDownloadTracking",["$window",function(){return function(e,t){return function(){var n,i;return"undefined"!=typeof s&&null!==s&&(s.linkTrackEvents+=",event198",s.events+=",event198",i=$.siteCatalyst.pageTrackingVariables(),n=$.extend({},i),n.eVar62=!0,s.linkTrackVars+=$.map(n,function(e,t){return t}).join(","),e&&(s.eVar62=t?"Leader Download":"Member Download"),s.tl(!0,"o","Download Image"))}}}])}.call(this),function(){this.IStockDownload.factory("goToInitiateDownloadAndSelectLicensesTracking",["$window",function(){return function(e,t,n){return function(){var i,r,o,c,a,l,u;if("undefined"==typeof s||null===s)return!1;if(s.linkTrackEvents="event45",s.events="event45",a="events,prop65",e&&(s.eVar62=t?"Leader Download":"Member Download",a+=",eVar62",s.events+=",event198",s.linkTrackEvents+=",event198"),c=$.siteCatalyst.pageTrackingVariables(),i=$.extend({},c),a&&a.length>0)for(l=a.split(","),r=0,o=l.length;r<o;r++)u=l[r],i[u]=!0;return s.linkTrackVars=$.map(i,function(e,t){return t}).join(","),s.tl(!0,"o",n.replace(/\s/g,""))}}}])}.call(this),function(){this.IStockDownload.factory("goToPurchaseAndSelectLicensesTracking",["$window",function(){return function(e,t,n){return function(){var i,r,o,c,a,l,u,d;if("undefined"==typeof s||null===s)return!1;if(s.linkTrackEvents="event45",s.events="event45",l="events,prop65",e&&(s.eVar62=t?"Leader Download":"Member Download",l+=",eVar62",s.events+=",event198",s.linkTrackEvents+=",event198"),a=$.siteCatalyst.pageTrackingVariables(),i=$.extend({},a),l&&l.length>0)for(u=l.split(","),o=0,c=u.length;o<c;o++)d=u[o],i[d]=!0;return s.linkTrackVars=$.map(i,function(e,t){return t}).join(","),s.tl(!0,"o",n.replace(/\s/g,"")),r="event141",s.linkTrackEvents=r,s.events=r,s.event141="P&P checkout click",s.tl(!0,"o","P&P checkout click")}}}])}.call(this),function(){this.IStockDownload.factory("performDownloadTracking",["agreementTypes","trackingService","eventBus",function(e,t,n){var i,r;return r=function(t){return t.asset.freeFile?"free_download":t.calc.redownloadForFree?"redownload":t.calc.selectedAgreementType===e.CREDIT_PACK?"credits":t.calc.selectedAgreementType===e.ROYALTY_FREE_SUBSCRIPTION?"subscription":null},i=function(e){return e.calc.hasSelectedOptionalLicenses?e.licenses.filter(function(e){return e.is_selected&&"Standard"!==e.license_type}).map(function(e){return e.license_type}).toArray():null},function(e){return n.trigger("track.singleDownload",{agreementType:e.calc.selectedAgreementType}),t.singleDownload(r(e),i(e))}}])}.call(this),function(){this.IStockDownload.factory("pickPaymentOptionTracking",["$window",function(){return function(e,t,n){return function(){var i,r,o,c,a,l,u;if("undefined"==typeof s||null===s)return!1;if(s.linkTrackEvents="event45",s.events="event45",a="events,prop65",e&&(s.eVar62=t?"Leader Download":"Member Download",a+=",eVar62",s.events+=",event198",s.linkTrackEvents+=",event198"),c=$.siteCatalyst.pageTrackingVariables(),i=$.extend({},c),a&&a.length>0)for(l=a.split(","),r=0,o=l.length;r<o;r++)u=l[r],i[u]=!0;return s.linkTrackVars=$.map(i,function(e,t){return t}).join(","),s.tl(!0,"o",n.replace(/\s/g,""))}}}])}.call(this),function(){this.IStockDownload.factory("pickPricingClarityPaymentOptionTracking",["$window",function(){return function(e){return function(){var t;return"undefined"!=typeof s&&null!==s&&("pricing"===e?(t="event141",s.linkTrackEvents=t,s.events=t,s.event141="P&P checkout click",s.tl(!0,"o","P&P checkout click")):"checkout"===e?(t="event140",s.linkTrackEvents=t,s.events=t,s.event140="fast checkout click",s.tl(!0,"o","fast checkout click")):void 0)}}}])}.call(this),function(){this.DeepRecord=function(){function e(){}var t,n,i,r;return t=function(e){return null!==e&&"object"==typeof e&&!Immutable.Iterable.isIterable(e)},n=function(e){return Immutable.List(e.map(function(e){return r(e)}))},i=function(e){var t,n;for(t in e)n=e[t],e[t]=r(n);return Immutable.Record(e)()},r=function(e){return t(e)?Array.isArray(e)?n(e):i(e):e},e.fromJS=function(e){return r(e)},e}()}.call(this);